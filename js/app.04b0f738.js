(function(){var e={74784:function(e,t,n){"use strict";var a=n(70538),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container",attrs:{id:"app"}},[n("router-view")],1)},o=[],s={name:"App"},r=s,c=n(1001),l=(0,c.Z)(r,i,o,!1,null,null,null),u=l.exports,p=n(78345),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("hello-metamask"),n("casino-component")],1)},b=[],y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"metamask-info"},[n("p",[e._v("Network: "+e._s(e.network))]),n("p",[e._v("Account: "+e._s(e.coinbase))]),n("p",[e._v("Polyjuice account "+e._s(e.polyjuiceAddress)+" ")]),n("p",[e._v(" Your balance ")]),n("p",[e._v("|| "+e._s(e.ckbBalance)+" CKB || "+e._s(e.ckETHBalance)+" ckETH "),n("button",{on:{click:e.toDeposit}},[e._v(" "+e._s(e.buttonName))])]),e.deposit?n("div",[n("p",[e._v(" 正在获取部署地址")]),n("div",{staticStyle:{width:"300px"}},[n("p",[e._v(e._s(e.ckL2Address))])]),e._m(0)]):e._e()])},m=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v(" 打开 "),n("a",{attrs:{target:"_blank",href:"https://force-bridge-dev.ckbapp.dev/"}},[e._v(" Force-bridge ")]),e._v(" 将上述地址粘贴到Recipient中,并稍等1～2min ")])}];const f={1:"Main Net",2:"Deprecated Morden test network",3:"Ropsten test network",4:"Rinkeby test network",42:"Kovan test network",4447:"Truffle Develop Network",5777:"Ganache Blockchain","0x116e1":"Godwoken Testnet"};var v=n(20629),w=n(10869),h={name:"hello-metamask",data:function(){return{deposit:!1,ckL2Address:null}},methods:{async toDeposit(){this.deposit=!this.deposit;let e=await(new w.AddressTranslator).getLayer2DepositAddress(this.$store.state.web3.web3Instance(),this.coinbase);this.ckL2Address=e.addressString},getL2DepositAddress:()=>{}},computed:(0,v.rn)({isInjected:e=>e.web3.isInjected,network:()=>f[window.ethereum.chainId],coinbase:e=>e.web3.coinbase,polyjuiceAddress:e=>e.web3.polyJuiceAddress,ckETHBalance:e=>e.web3.ckETH_balance,ckbBalance:e=>{if(null!==e.web3.web3Instance)return e.web3.balance/1e8},buttonName:function(){return this.deposit?"Close":"Deposit"}})},_=h,g=(0,c.Z)(_,y,m,!1,null,"91c3b422",null),T=g.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"casino container"},[n("p",[e._v("=💰===💰💰===💰💰===💰💰===💰💰===💰💰===💰💰===💰💰===💰=")]),n("h1",[e._v("Welcome to the Casino 欢迎来到CKBet")]),n("p",[e._v("=💰===💰💰===💰💰===💰💰===💰💰===💰💰===💰💰===💰💰===💰=")]),n("h4",[e._v("First: Enter amount of ckb you want to bet💵")]),n("h3",[e._v("Amount to bet: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.amount,expression:"amount"}],attrs:{placeholder:"0 ckb"},domProps:{value:e.amount},on:{input:function(t){t.target.composing||(e.amount=t.target.value)}}})]),n("h4",[e._v("Then: ⬇️⬇️⬇️ pick a number between 1 and 10, and good lock! ⬇️⬇️⬇️")]),n("ul",[n("li",{on:{click:e.clickNumber}},[e._v("1")]),n("li",{on:{click:e.clickNumber}},[e._v("2")]),n("li",{on:{click:e.clickNumber}},[e._v("3")]),n("li",{on:{click:e.clickNumber}},[e._v("4")]),n("li",{on:{click:e.clickNumber}},[e._v("5")]),n("li",{on:{click:e.clickNumber}},[e._v("6")]),n("li",{on:{click:e.clickNumber}},[e._v("7")]),n("li",{on:{click:e.clickNumber}},[e._v("8")]),n("li",{on:{click:e.clickNumber}},[e._v("9")]),n("li",{on:{click:e.clickNumber}},[e._v("10")])]),e.pending?n("p",[e._v(" 正在投骰子中🎲🎲🎲🎲 ")]):e._e(),e.pending?n("img",{attrs:{id:"loader",src:"https://media.giphy.com/media/Y2ZUWLrTy63j9T6qrK/giphy.gif"}}):e._e(),e.winEvent?n("div",{staticClass:"event"},[e.winEvent._status?n("p",{attrs:{id:"has-won"}},[n("i",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}}),e._v(" 🎉🎉Congragulations, you have won "+e._s(e.winEvent._amount/1e8)+" CKB")]):n("p",{attrs:{id:"has-lost"}},[n("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}}),e._v(" 🤪🤪Sorry you lost, try again 🙌🙌 ")])]):e._e()])},E=[],A={name:"casino",data(){return{amount:null,pending:!1,winEvent:null}},methods:{clickNumber(e){console.log("BETTING ON NUMBER, AMOUNT",e.target.innerHTML,this.amount),this.winEvent=null,this.pending=!0,this.$store.state.contractInstance().methods.bet(e.target.innerHTML).send({gas:6e6,value:1e8*this.amount,from:this.$store.state.web3.coinbase}).on("receipt",(e=>{console.log(e),this.pending=!1,console.log("Receipt"),this.winEvent=e.events.Won.returnValues})).on("error",(e=>{console.error(e),this.pending=!1,alert("Network error, please try again")}))}},mounted(){console.log("dispatching getContractInstance"),this.$store.dispatch("getContractInstance")}},I=A,C=(0,c.Z)(I,k,E,!1,null,"387c9003",null),H=C.exports,O={name:"casino-dapp",beforeCreate(){console.log("registerWeb3 Action dispatched from casino-dapp.vue"),this.$store.dispatch("registerWeb3")},components:{"hello-metamask":T,"casino-component":H}},x=O,M=(0,c.Z)(x,d,b,!1,null,"1e84c4a3",null),N=M.exports;a.Z.use(p.Z);var P=new p.Z({routes:[{path:"/",name:"casino-dapp",component:N}]});let W={web3:{isInjected:!1,web3Instance:null,networkId:null,coinbase:null,balance:null,error:null,polyJuiceAddress:null,ckETH_balance:null},contractInstance:null,sudtInstance:null};var j=W,L=n(3283),S=n.n(L);const B={WEB3_PROVIDER_URL:"http://124.160.125.200:3001/godwoken-testnet-web3-rpc.ckbapp.dev",ROLLUP_TYPE_HASH:"0x4cc2e6526204ae6a2e8fcf12f7ad472f41a1606d5b9624beebd215d780809f6a",ETH_ACCOUNT_LOCK_CODE_HASH:"0xdeec13a7b8e100579541384ccaf4b5223733e4a5483c3aec95ddc4c1d5ea5b22"};var R=n(95564);let D=new Promise((function(e){const t=B.WEB3_PROVIDER_URL,n={rollupTypeHash:B.ROLLUP_TYPE_HASH,ethAccountLockCodeHash:B.ETH_ACCOUNT_LOCK_CODE_HASH,web3Url:t},a=new R.PolyjuiceHttpProvider(t,n),i=new(S())(a);e({injectedWeb3:!1,web3(){return i}})})).then((e=>new Promise((function(t){const n=window.ethereum.selectedAddress;console.log(n),e=Object.assign({},e,{coinbase:n}),t(e)})))).then((e=>new Promise((function(t,n){e.web3().eth.getBalance(e.coinbase,((a,i)=>{a?n(new Error("Unable to retrieve balance for address: "+e.coinbase)):(e=Object.assign({},e,{balance:i}),t(e))}))}))));var U=D;let Z=function(e){console.debug(e);let t=window.ethereum;setInterval((async()=>{let e=q.state.web3.polyJuiceAddress,t=q.state.web3.coinbase,n=await q.state.sudtInstance().methods.balanceOf(e).call();q.dispatch("pollWeb3",{coinbase:t,balance:q.state.web3.balance,polyJuiceAddress:e,ckETH_balance:n/1e18})}),15e3),setInterval((()=>{if(t&&q.state.web3.web3Instance){let e=q.state.web3.coinbase,n=q.state.web3.polyJuiceAddress;q.state.web3.web3Instance().eth.getBalance(t.selectedAddress,(function(t,a){t?console.log(t):q.dispatch("pollWeb3",{coinbase:e,balance:parseInt(a,10),polyJuiceAddress:n,ckETH_balance:q.state.web3.ckETH_balance})}))}}),5e3),setInterval((()=>{if(t&&q.state.web3.web3Instance){let e=t.selectedAddress,n=(new w.AddressTranslator).ethAddressToGodwokenShortAddress(e);q.dispatch("pollWeb3",{coinbase:e,balance:q.state.web3.balance,polyJuiceAddress:n,ckETH_balance:q.state.web3.ckETH_balance})}}),500)};var $=Z;const J="0x604eD4c60b6d0846e2E403aDa42FE5e3De4d4B8e",F=[{constant:!1,inputs:[{name:"_number",type:"uint256"}],name:"bet",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"houseEdge",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"_houseEdge",type:"uint256"}],payable:!0,stateMutability:"payable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"_status",type:"bool"},{indexed:!1,name:"_amount",type:"uint256"}],name:"Won",type:"event"}],K="0x5704bf4a134181b4f3C74eaFB4150412F312F629",V=[{inputs:[{internalType:"string",name:"name_",type:"string"},{internalType:"string",name:"symbol_",type:"string"},{internalType:"uint256",name:"totalSupply_",type:"uint256"},{internalType:"uint256",name:"sudtId_",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"sudtId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}];let Y=new Promise((function(e){const t=B.WEB3_PROVIDER_URL,n={rollupTypeHash:B.ROLLUP_TYPE_HASH,ethAccountLockCodeHash:B.ETH_ACCOUNT_LOCK_CODE_HASH,web3Url:t},a=new R.PolyjuiceHttpProvider(t,n),i=new(S())(a);let o=new i.eth.Contract(F,J);console.log(o);let s=new i.eth.Contract(V,K);e([o,s])}));var G=Y;a.Z.use(v.ZP);const q=new v.ZP.Store({strict:!0,state:j,mutations:{registerWeb3Instance(e,t){console.log("registerWeb3instance Mutation being executed",t);let n=t,a=e.web3;a.coinbase=n.coinbase,a.networkId=n.networkId,a.balance=parseInt(n.balance,10),a.isInjected=n.injectedWeb3,a.web3Instance=n.web3,e.web3=a,$()},pollWeb3Instance(e,t){e.web3.coinbase=t.coinbase,e.web3.balance=parseInt(t.balance,10),e.web3.ckETH_balance=t.ckETH_balance,e.web3.polyJuiceAddress=t.polyJuiceAddress},registerContractInstance(e,t){console.log("Casino contract instance: ",t),e.contractInstance=()=>t},registerSudtContractInstance(e,t){console.log("Casino contract instance: ",t),e.sudtInstance=()=>t}},actions:{registerWeb3({commit:e}){console.log("registerWeb3 Action being executed"),U.then((t=>{console.log("committing result to registerWeb3Instance mutation"),e("registerWeb3Instance",t)})).catch((e=>{console.log("error in action registerWeb3",e)}))},pollWeb3({commit:e},t){e("pollWeb3Instance",t)},getContractInstance({commit:e}){G.then((t=>{console.log(t),e("registerContractInstance",t[0]),e("registerSudtContractInstance",t[1])})).catch((e=>console.log(e)))}}});a.Z.config.productionTip=!1,new a.Z({el:"#app",router:P,store:q,components:{App:u},template:"<App/>"})},5879:function(){},46601:function(){},89214:function(){},71922:function(){},2363:function(){},15100:function(){},27790:function(){},75950:function(){},52361:function(){},94616:function(){},88924:function(){}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var o=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,a,i,o){if(!a){var s=1/0;for(u=0;u<e.length;u++){a=e[u][0],i=e[u][1],o=e[u][2];for(var r=!0,c=0;c<a.length;c++)(!1&o||s>=o)&&Object.keys(n.O).every((function(e){return n.O[e](a[c])}))?a.splice(c--,1):(r=!1,o<s&&(s=o));if(r){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,i,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,o,s=a[0],r=a[1],c=a[2],l=0;for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(c)var u=c(n);for(t&&t(a);l<s.length;l++)o=s[l],n.o(e,o)&&e[o]&&e[o][0](),e[s[l]]=0;return n.O(u)},a=self["webpackChunkckbet"]=self["webpackChunkckbet"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(74784)}));a=n.O(a)})();
//# sourceMappingURL=app.04b0f738.js.map